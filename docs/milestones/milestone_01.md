# Milestone 1 – Core Protocol Definitions

> **Status:** Planned / Tracking
> **Target Version:** OmniBase v0.5.0
> **DRI:** core‑protocols sub‑team (@alice, @ben, @chuang)
> **Last Updated:** 2025‑05‑16

---

## Objective

Establish the **foundational type system** on which the rest of OmniBase is built:

* `Artifact[T]` & concrete subclasses (`FileArtifact`, `DirectoryTreeArtifact`, …)
* `Result[U]` & concrete subclasses (`ValidationResult`, `TransformResult`, …)
* `ExecutionContext`
* Versioning semantics for each (`SCHEMA_VERSION` / `__protocol_version__`)
* Sync and async runnable signatures

These definitions unblock the registry, orchestrator, and testing workstreams.

---

## Deliverables

|  #    |  Deliverable                              |  Description                                                  |  Owner   |
| ----- | ----------------------------------------- | ------------------------------------------------------------- | -------- |
|  D1   |  `core/abcs/artifact.py`                  |  Abstract Base Class `ArtifactABC[T]` with `SCHEMA_VERSION`   |  Alice   |
|  D2   |  `protocols/testing/artifact.py`          |  `typing.Protocol` mirror with `__protocol_version__`         |  Ben     |
|  D3   |  Concrete File/Dir artifacts              |  `FileArtifact`, `DirectoryTreeArtifact` (& basic hash calc)  |  Chuang  |
|  D4   |  `core/abcs/result.py`                    |  `ResultABC[U]` (+ `UnifiedResultModel`)                      |  Alice   |
|  D5   |  `protocols/testing/result.py`            |  Protocol mirror for `Result`                                 |  Ben     |
|  D6   |  `core/abcs/execution_context.py`         |  As spec’d; includes config + logger access                   |  Chuang  |
|  D7   |  Protocol mirror for `ExecutionContext`   |                                                               |  Ben     |
|  D8   |  `core/abcs/runnable.py`                  |  Sync & async runnable ABCs                                   |  Alice   |
|  D9   |  Tests                                    |  MyPy compliance, runtime checks, basic unit tests            |  Team    |
|  D10  |  Docs                                     |  Autogenerated API docs; spec excerpt in `docs/protocols.md`  |  Alice   |

---

## Work Breakdown Structure (WBS)

1. **Design session** – sign‑off on generic type parameters, minimal required methods
2. Skeleton PR with empty modules & version constants
3. Parallel development of ABCs & Protocol mirrors
4. Integrate into MyPy config + CI
5. Implement concrete artifact/result models
6. Write tests & example usages
7. Docs generation pipeline hook‑up

---

## Timeline (tentative)

|  Week             |  Tasks                                                |
| ----------------- | ----------------------------------------------------- |
|  W20 (May 20‑24)  |  Design review, skeleton PR merged                    |
|  W21 (May 27‑31)  |  ABCs & Protocols implementation (D1‑D2, D4‑D6)       |
|  W22 (Jun 3‑7)    |  Concrete models & hashing (D3), runnable ABCs (D8)   |
|  W23 (Jun 10‑14)  |  Tests + MyPy CI (D9)                                 |
|  W24 (Jun 17‑21)  |  Docs generation & publishing (D10); Milestone review |

---

## Acceptance Criteria

* ✅ Types compile with MyPy under `strict = True`
* ✅ Runtime `isinstance`/`issubclass` behaviour matches expectations
* ✅ `flake8‑omnibase` OB1xx rules pass (no production import from `protocols.testing`)
* ✅ Basic unit tests (>90 % coverage for new modules)
* ✅ API reference pages generated in docs site
* ✅ Milestone review sign‑off by foundation‑team

---

## Dependencies & Risks

* **Dependency:** Decision on generic variance rules (covariant/contravariant) – needed before coding.
* **Risk:** Over‑engineering initial models; mitigate via strict scope lock.
* **Risk:** Hashing algorithm bikeshedding; agree on SHA‑256 for v0.5.0.

---

## Links & References

* Parent Spec: `docs/omnibase/omnibase_design_spec.md` (§ "Canonical Principles → Function‑as‑Unit")
* Async interface: Design Addendum v0.4.1 (§2)
* Compatibility policy matrix (§ Protocol vs ABC Guidelines)

---

> When all deliverables are merged to `main` and acceptance criteria met, mark this milestone **complete** and unlock Milestone 2 – Registry Infrastructure.
