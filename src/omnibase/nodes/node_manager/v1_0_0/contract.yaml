# Canonical ONEX contract for the node_manager node.
# To extend this contract for your node:
# - Add new input/output fields in the input_state/output_state sections below.
# - Add new error codes in your node's error_codes.py and reference them in your node logic.
# - If your node requires backend/event bus logic, document and add configuration fields here as needed (see Kafka node for example).
# This contract is the single source of truth for all node state and protocol extensions.
---

contract_version: 1.0.0
node_name: node_manager
node_version: 1.0.0
contract_name: node_manager_contract
contract_description: State contract for node_manager
input_state:
  type: object
  properties:
    version:
      $ref: '#/definitions/SemVerModel'
      description: Schema version for input state
    input_field:
      type: string
      description: Required input field for node_manager
    optional_field:
      $ref: '#/definitions/OnexFieldModel'
      description: Optional input field for node_manager
    external_dependency:
      type: boolean
      description: Optional flag to simulate integration context for scenario-driven testing
    # Traceability fields (ONEX standard)
    event_id:
      type: string
      description: Unique event identifier (UUID)
    correlation_id:
      type: string
      description: Correlation ID for tracing requests/events
    node_name:
      type: string
      description: Name of the node processing the event
    node_version:
      $ref: '#/definitions/SemVerModel'
      description: Version of the node
    timestamp:
      type: string
      format: date-time
      description: ISO8601 timestamp of the event
  required:
    - version
    - input_field
output_state:
  type: object
  properties:
    version:
      $ref: '#/definitions/SemVerModel'
      description: Schema version for output state (matches input)
    status:
      type: string
      enum:
        - success
        - warning
        - error
        - skipped
        - fixed
        - partial
        - info
        - unknown
      description: Execution status
    message:
      type: string
      description: Human-readable result message
    output_field:
      $ref: '#/definitions/ModelNodeManagerOutputField'
    event_id:
      type: string
      description: Unique event identifier (UUID)
    correlation_id:
      type: string
      description: Correlation ID for tracing requests/events
    node_name:
      type: string
      description: Name of the node processing the event
    node_version:
      $ref: '#/definitions/SemVerModel'
      description: Version of the node
    timestamp:
      type: string
      format: date-time
      description: ISO8601 timestamp of the event
  required:
    - version
    - status
    - message
# To extend output fields, see the ModelNodeManagerOutputField definition below.

error_codes:
  - UNKNOWN_ERROR
  - INVALID_PARAMETER
  - MISSING_REQUIRED_PARAMETER
  - SCHEMA_VALIDATION_FAILED
  - UNSUPPORTED_OPERATION

examples:
  valid_input:
    version: 1.0.0
    input_field: example_value
    optional_field: optional_value
    event_id: "123e4567-e89b-12d3-a456-426614174000"
    correlation_id: "corr-abc-123"
    node_name: "node_manager"
    node_version: "1.0.0"
    timestamp: "2025-06-06T12:00:00Z"
  valid_output:
    version: 1.0.0
    status: success
    message: Operation completed successfully
    output_field:
      data:
        result: example
    event_id: "123e4567-e89b-12d3-a456-426614174000"
    correlation_id: "corr-abc-123"
    node_name: "node_manager"
    node_version: "1.0.0"
    timestamp: "2025-06-06T12:00:00Z"

definitions:
  OnexFieldModel:
    type: object
    properties:
      data:
        type: object
        description: Arbitrary ONEX field data
  ModelNodeManagerOutputField:
    type: object
    # To extend the output field model for your node, add new properties here.
    # Example: add 'custom: object' or 'integration: boolean' for new output data.
    # This model is auto-generated into models/state.py and should be referenced in all output logic.
    properties:
      result:
        type: string
        description: Example result field for node_manager
      details:
        type: object
        nullable: true
        description: Optional details for output
    required:
      - result
  SemVerModel:
    type: object
    properties:
      major:
        type: integer
      minor:
        type: integer
      patch:
        type: integer
      prerelease:
        type: string
        nullable: true
      build:
        type: string
        nullable: true
    required:
      - major
      - minor
      - patch
    description: Semantic version model for ONEX nodes

hash: 406d07a5a0377549a710ae4855b7f98fd009f866d701575e4b825ed5f282aae9
last_modified_at: '2025-06-06T00:00:00Z'
